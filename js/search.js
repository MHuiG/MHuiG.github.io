var HexoSearch,SearchService="";!function(o){SearchService=function(e){var n=this;n.config=o.extend({per_page:10,selectors:{body:"body",form:".u-search-form",input:".u-search-input",container:"#u-search",modal:"#u-search .modal",modal_body:"#u-search .modal-body",modal_footer:"#u-search .modal-footer",modal_overlay:"#u-search .modal-overlay",modal_results:"#u-search .modal-results",modal_metadata:"#u-search .modal-metadata",modal_error:"#u-search .modal-error",modal_loading_bar:"#u-search .modal-loading-bar",modal_ajax_content:"#u-search .modal-ajax-content",modal_logo:"#u-search .modal-footer .logo",btn_close:"#u-search .btn-close",btn_next:"#u-search .btn-next",btn_prev:"#u-search .btn-prev"}},e),n.dom={},n.percentLoaded=0,n.open=!1,n.queryText="",n.nav={next:-1,prev:-1,total:0,current:1},n.parseSelectors=function(){for(var e in n.config.selectors)n.dom[e]=o(n.config.selectors[e])},n.beforeQuery=function(){n.open||n.dom.container.fadeIn(),n.dom.input.each(function(e,a){o(a).val(n.queryText)}),document.activeElement.blur(),n.dom.modal_error.hide(),n.dom.modal_ajax_content.removeClass("loaded"),n.startLoading()},n.afterQuery=function(){n.dom.modal_body.scrollTop(0),n.dom.modal_ajax_content.addClass("loaded"),n.stopLoading()},n.search=function(e,a){n.beforeQuery(),n.search instanceof Function?n.query(n.queryText,e,function(){n.afterQuery()}):(console.log("query() does not exist."),n.onQueryError(n.queryText,""),n.afterQuery())},n.onQueryError=function(e,a){var o="success"===a?'No result found for "'+e+'".':"timeout"===a?"Unfortunate timeout.":"Mysterious failure.";n.dom.modal_results.html(""),n.dom.modal_error.html(o),n.dom.modal_error.show()},n.nextPage=function(){-1!==n.nav.next&&n.search(n.nav.next)},n.prevPage=function(){-1!==n.nav.prev&&n.search(n.nav.prev)},n.getUrlRelativePath=function(e){var a=e.split("//"),o=a[1].indexOf("/"),t=a[1].substring(o);return-1!=t.indexOf("?")&&(t=t.split("?")[0]),t},n.buildResult=function(e,a,o){var t="",t="<li>";return t+="<a class='result' href='"+n.getUrlRelativePath(e)+"'>",t+="<span class='title'>"+a+"</span>",""!==o&&(t+="<span class='digest'>"+o+"</span>"),(t+="</a>")+"</li>"},n.close=function(){n.open=!1,n.dom.container.fadeOut(),n.dom.body.removeClass("modal-active")},n.onSubmit=function(e){e.preventDefault(),n.queryText=o(this).find(".u-search-input").val(),n.queryText&&n.search(1)},n.startLoading=function(){n.dom.modal_loading_bar.show(),n.loadingTimer=setInterval(function(){n.percentLoaded=Math.min(n.percentLoaded+5,95),n.dom.modal_loading_bar.css("width",n.percentLoaded+"%")},100)},n.stopLoading=function(){clearInterval(n.loadingTimer),n.dom.modal_loading_bar.css("width","100%"),n.dom.modal_loading_bar.fadeOut(),setTimeout(function(){n.percentLoaded=0,n.dom.modal_loading_bar.css("width","0%")},300)},n.destroy=function(){n.dom.form.each(function(e,a){o(a).off("submit")}),n.dom.modal_overlay.off("click"),n.dom.btn_close.off("click"),n.dom.btn_next.off("click"),n.dom.btn_prev.off("click"),n.dom.container.remove()},n.init=function(){o("body").append(a),n.parseSelectors(),n.dom.modal_footer.show(),n.dom.form.each(function(e,a){o(a).on("submit",n.onSubmit)}),n.dom.modal_overlay.on("click",n.close),n.dom.btn_close.on("click",n.close),n.dom.btn_next.on("click",n.nextPage),n.dom.btn_prev.on("click",n.prevPage)},n.init()};var a='<div id="u-search"><div class="modal"> <header class="modal-header" class="clearfix"><form id="u-search-modal-form" class="u-search-form" name="uSearchModalForm"> <input type="text" id="u-search-modal-input" class="u-search-input" /> <button type="submit" id="u-search-modal-btn-submit" class="u-search-btn-submit"> <span class="fas fa-search"></span> </button></form> <a class="btn-close"> <span class="fas fa-times"></span> </a><div class="modal-loading"><div class="modal-loading-bar"></div></div> </header> <main class="modal-body"><ul class="modal-results modal-ajax-content"></ul> </main> <footer class="modal-footer clearfix"><div class="modal-metadata modal-ajax-content"> <strong class="range"></strong> of <strong class="total"></strong></div><div class="modal-error"></div> <div class="logo"></div> <a class="nav btn-next modal-ajax-content"> <span class="text">NEXT</span> <span class="fal fa-chevron-right"></span> </a> <a class="nav btn-prev modal-ajax-content"> <span class="fal fa-chevron-left"></span> <span class="text">PREV</span> </a> </footer></div><div class="modal-overlay"></div></div>'}(jQuery),function(f){"use strict";HexoSearch=function(e){SearchService.apply(this,arguments);var r=this;return r.config.endpoint=ROOT+((e||{}).endpoint||"content.json"),r.config.endpoint=r.config.endpoint.replace("//","/"),r.cache="",r.contentSearch=function(r,e){var s=r.title.trim().toLowerCase(),c=r.text.trim().toLowerCase(),d=e.trim().toLowerCase().split(" "),l=!1,i=-1,u=-1,m=-1;return""!==s&&""!==c&&f.each(d,function(e,a){var o,t,n;i=s.indexOf(a),u=c.indexOf(a),i<0&&u<0?l=!1:(l=!0,u<0&&(u=0),0===e&&(m=u)),l&&(c=r.text.trim(),(t=o=0)<=m?(t=0===(o=Math.max(m-40,0))?Math.min(200,c.length):Math.min(m+120,c.length),n=c.substring(o,t),d.forEach(function(e){var a=new RegExp(e,"gi");n=n.replace(a,"<b mark>"+e+"</b>")}),r.digest=n+"......"):(t=Math.min(200,c.length),r.digest=c.trim().substring(0,t)))}),l},r.buildResultList=function(e,o){var t="";return f.each(e,function(e,a){r.contentSearch(a,o)&&(t+=r.buildResult(a.permalink,a.title,a.digest))}),t+="<script>try{pjax.refresh(document.querySelector('#u-search'));document.addEventListener('pjax:send',function(){$('#u-search').fadeOut(500);$('body').removeClass('modal-active')});}catch(e){$('#u-search').fadeOut(500);}<\/script>"},r.buildMetadata=function(e){r.dom.modal_footer.hide()},r.query=function(t,e,n){var a;r.cache?(a="",a+=r.buildResultList(r.cache.pages,t),a+=r.buildResultList(r.cache.posts,t),r.dom.modal_results.html(a),r.buildMetadata(r.cache),n&&n(r.cache)):f.get(r.config.endpoint,{key:r.config.apiKey,cx:r.config.engineId,q:t,start:e,num:r.config.per_page},function(e,a){var o;"success"!==a||!e||!e.posts&&!e.pages||e.posts.length<1&&e.pages.length<1?r.onQueryError(t,a):(r.cache=e,o="",o+=r.buildResultList(e.pages,t),o+=r.buildResultList(e.posts,t),r.dom.modal_results.html(o)),r.buildMetadata(e),n&&n(e)})},r}}(jQuery);