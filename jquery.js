const prefix="MHuiG-Blog",cacheSuffixVersion="00000005-0.32651186339651006",CACHE_NAME=prefix+"-v"+cacheSuffixVersion,PreCachlist=["/css/style.7c0ce3b3.css","/js/app.af2d54c8.js","/js/search/hexo.0e52f222.js"];let NPMMirror=!0,NPMTarball=!0;const NPMPackage="@mhg/blog";let NPMPackageVersion="1.0.1655535370401",debug=!1,tarball=!1;"localhost"==location.hostname&&(debug=!0)&&(NPMMirror=!0);const cors_anywhere="https://cors.mhuig.top?url=",handleFetch=async e=>{const r=e.request.url;return/nocache/.test(r)||/api\.mhuig\.top/.test(r)||/captcha/.test(r)||/token/.test(r)?NetworkOnly(e):/@latest/.test(r)?CacheFirst(e):/cdnjs\.cloudflare\.com/.test(r)||/music\.126\.net/.test(r)||/qqmusic\.qq\.com/.test(r)||/jsdelivr\.net/.test(r)||/static\.mhuig\.top/.test(r)||/npm\.elemecdn\.com/.test(r)||/unpkg\.com/.test(r)||/.*\.(?:png|jpg|jpeg|svg|gif|webp|ico|eot|ttf|woff|woff2|mp3)$/.test(r)||/.*\.(css|js)$/.test(r)?CacheAlways(e):CacheFirst(e)},cdn={gh:{jsdelivr:"https://cdn.jsdelivr.net/gh",fastly:"https://fastly.jsdelivr.net/gh",gcore:"https://gcore.jsdelivr.net/gh",testingcf:"https://testingcf.jsdelivr.net/gh",test1:"https://test1.jsdelivr.net/gh",mhuig:"https://static.mhuig.top/gh"},combine:{jsdelivr:"https://cdn.jsdelivr.net/combine",fastly:"https://fastly.jsdelivr.net/combine",gcore:"https://gcore.jsdelivr.net/combine",testingcf:"https://testingcf.jsdelivr.net/combine",test1:"https://test1.jsdelivr.net/combine"},npm:{jsdelivr:"https://cdn.jsdelivr.net/npm",fastly:"https://fastly.jsdelivr.net/npm",gcore:"https://gcore.jsdelivr.net/npm",testingcf:"https://testingcf.jsdelivr.net/npm",test1:"https://test1.jsdelivr.net/npm",eleme:"https://npm.elemecdn.com",unpkg:"https://unpkg.com",mhuig:"https://static.mhuig.top/npm"}},cdn_match_list=[];for(const e in cdn)for(const r in cdn[e])cdn_match_list.push({type:e,key:cdn[e][r]});const _console=console,color={black:"#000000",red:"#FF0000",green:"#008000",yellow:"#FFFF00",blue:"#0000FF",magenta:"#FF00FF",cyan:"#00FFFF",white:"#FFFFFF"},add=(...e)=>{let r=[[]];for(let t=0;t<e.length;t++){const[o,...a]=e[t];r[0]+=o,r=r.concat(a)}return r},createlog=e=>(...r)=>{("error"==e?_console[e]:_console.log).apply(void 0,r)},creategroup=e=>(...e)=>{_console.groupCollapsed.apply(void 0,e)},colorUtils={bold:e=>{if("string"==typeof e||"number"==typeof e)return`${e};font-weight: bold;`;for(let r=1;r<e.length;r++)e[r]+=";font-weight: bold;";return e}},colorHash={log:"black",wait:"cyan",error:"red",warn:"yellow",ready:"green",info:"blue",event:"magenta"},createChalk=e=>(...r)=>{if("object"==typeof r[0])return void createlog(e)(...add(colorUtils.bold(colorUtils[colorHash[e]](`[${firstToUpperCase(e)}] `)),...r));let t=r;"string"!=typeof r&&"number"!=typeof r||(t=colorUtils[colorHash[e]](r)),createlog(e)(...add(colorUtils.bold(colorUtils[colorHash[e]](`[${firstToUpperCase(e)}] `)),t))},createChalkBg=e=>(...r)=>{if("object"==typeof r[0])return void createlog(e)(...add(colorUtils.bold(colorUtils[`bg${firstToUpperCase(colorHash[e])}`](`[${firstToUpperCase(e)}] `)),...r));let t=r;"string"!=typeof r&&"number"!=typeof r||(t=colorUtils[colorHash[e]](r)),createlog(e)(...add(colorUtils.bold(colorUtils[`bg${firstToUpperCase(colorHash[e])}`](`[${firstToUpperCase(e)}] `)),t))},createChalkGroup=e=>(...r)=>{if("object"==typeof r[0])return void creategroup()(...add(colorUtils.bold(colorUtils[colorHash[e]](`[${firstToUpperCase(e)}] `)),...r));let t=r;"string"!=typeof r&&"number"!=typeof r||(t=colorUtils[colorHash[e]](r)),creategroup()(...add(colorUtils.bold(colorUtils[colorHash[e]](`[${firstToUpperCase(e)}] `)),t))},chalk={group:{end:_console.groupEnd},bg:{}};Object.keys(colorHash).forEach((e=>{var r;chalk[e]=(r=e,(...e)=>{if("object"==typeof e[0])return void createlog(r)(...add(colorUtils.bold(colorUtils[colorHash[r]](`[${firstToUpperCase(r)}] `)),...e));let t=e;"string"!=typeof e&&"number"!=typeof e||(t=colorUtils[colorHash[r]](e)),createlog(r)(...add(colorUtils.bold(colorUtils[colorHash[r]](`[${firstToUpperCase(r)}] `)),t))}),chalk.group[e]=createChalkGroup(e),chalk.bg[e]=createChalkBg(e)}));const firstToUpperCase=e=>e.toLowerCase().replace(/( |^)[a-z]/g,(e=>e.toUpperCase()));Object.keys(color).forEach((e=>{colorUtils[e]=r=>{if("string"==typeof r||"number"==typeof r)return[`%c${r}`,`color:${color[e]}`];for(let t=1;t<r.length;t++)r[t]+=`;color:${color[e]}`;return r},colorUtils[`bg${firstToUpperCase(e)}`]=r=>{if("string"==typeof r||"number"==typeof r)return[`%c${r}`,`padding: 2px 4px; border-radius: 3px; color: ${"white"===e?"#000":"#fff"}; font-weight: bold; background:${color[e]};`];for(let t=1;t<r.length;t++)r[t]+=`;padding: 2px 4px; border-radius: 3px; font-weight: bold; background:${color[e]};`;return r}})),logger={add:add,...chalk,...colorUtils},debug||(logger={log:()=>{},wait:()=>{},error:()=>{},warn:()=>{},ready:()=>{},info:()=>{},event:()=>{},group:{log:()=>{},wait:()=>{},error:()=>{},warn:()=>{},ready:()=>{},info:()=>{},event:()=>{},end:()=>{}},bg:{log:()=>{},wait:()=>{},error:()=>{},warn:()=>{},ready:()=>{},info:()=>{},event:()=>{}}},console.log=()=>{});const generate_uuid=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=16*Math.random()|0;return("x"==e?r:3&r|8).toString(16)}));self.db={read:(e,r)=>(r||(r={type:"text"}),new Promise(((r,t)=>{caches.open(CACHE_NAME).then((t=>{t.match(new Request(`https://LOCALCACHE/${encodeURIComponent(e)}`)).then((function(e){e||r(null),e.text().then((e=>r(e)))})).catch((()=>{r(null)}))}))}))),write:(e,r)=>new Promise(((t,o)=>{caches.open(CACHE_NAME).then((function(o){o.put(new Request(`https://LOCALCACHE/${encodeURIComponent(e)}`),new Response(r)),t()})).catch((()=>{o()}))}))};const compareVersion=(e,r)=>{v1=e.split("."),v2=r.split(".");const t=Math.max(v1.length,v2.length);for(;v1.length<t;)v1.push("0");for(;v2.length<t;)v2.push("0");for(let o=0;o<t;o++){const t=parseInt(v1[o]),a=parseInt(v2[o]);if(t>a)return e;if(t<a)return r}return e},mirrors=["https://registry.npmjs.org/@mhg/blog/latest","https://registry.npmmirror.com/@mhg/blog/latest","https://mirrors.cloud.tencent.com/npm/@mhg/blog/latest"],getLocalVersion=async()=>{NPMPackageVersion=await db.read("blog_version")||NPMPackageVersion,logger.bg.info(`Local Version: @mhg/blog@${NPMPackageVersion}`)};let mirror_time=0;const setNewestVersion=async()=>{if(!NPMMirror)return;let e=null;return e=mirror_time%(mirrors.length+1)?fetch(mirrors[mirror_time%(mirrors.length+1)-1]):fetchAny(mirrors),mirror_time++,e.then((e=>e.json())).then((async e=>{if(!e.version)throw"No Version Found!";tarball=e.dist.tarball,await db.write("tarball",tarball);const r=await db.read("blog_version")||NPMPackageVersion;NPMPackageVersion=compareVersion(e.version,r),logger.bg.ready(`@mhg/blog@${NPMPackageVersion}`),r!==NPMPackageVersion&&NPMMirror&&(await db.write("NPMMirror","true"),await db.write("NPMTarball","false"),logger.bg.ready("[CacheAlways] NPM Mirror Enabled!"),caches.delete(CACHE_NAME+"-npmtgz"),logger.ready("deleted cache npmtgz")),await getNpmSource(),await db.write("blog_version",NPMPackageVersion)})).catch((e=>{logger.error("[Set Newest Version] "+(e.stack||e))}))};setInterval((async()=>{await setNewestVersion()}),6e4),setTimeout((async()=>{await setNewestVersion()}),5e3);const installFunction=async()=>(await getLocalVersion(),caches.open(CACHE_NAME+"-precache").then((async function(e){if(await db.read("uuid")||await db.write("uuid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=16*Math.random()|0;return("x"==e?r:3&r|8).toString(16)}))),await db.read("NPMMirror")||await db.write("NPMMirror",NPMMirror),await db.read("NPMTarball")||await db.write("NPMTarball","false"),tarball=await db.read("tarball"),await db.write("DownloadingNPMSource","false"),PreCachlist.length){logger.group.event(`Precaching ${PreCachlist.length} files.`);let r=0;PreCachlist.forEach((function(t){e.match(new Request(t)).then((function(o){o?logger.ready(`Precaching ${t}`):(logger.wait(`Precaching ${t}`),e.add(new Request(t))),r++,r===PreCachlist.length&&(logger.ready(`Precached ${PreCachlist.length} files.`),logger.group.end())}))}))}})).catch((e=>{logger.error("[install] "+(e.stack||e))})));self.addEventListener("install",(async function(e){logger.bg.event("service worker install event listening");try{self.skipWaiting(),e.waitUntil(installFunction()),logger.bg.ready("service worker install sucess!")}catch(e){logger.error("[install] "+(e.stack||e))}})),self.addEventListener("activate",(async e=>{logger.bg.event("service worker activate event listening");try{e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{e.includes(cacheSuffixVersion)||(caches.delete(e),logger.bg.ready("Deleted Outdated Cache: "+e))}))))).catch((e=>{logger.error("[activate] "+(e.stack||e))}))),await self.clients.claim(),logger.bg.ready("service worker activate sucess!")}catch(e){logger.error("[activate] "+(e.stack||e))}})),self.addEventListener("fetch",(async e=>{e.respondWith(handleFetch(e).catch((r=>{logger.error("[fetch] "+e.request.url+"\n[error] "+(r.stack||r))})))}));const NetworkOnly=async e=>(logger.group.info("NetworkOnly: "+new URL(e.request.url).pathname),logger.wait("service worker fetch: "+e.request.url),logger.group.end(),fetch(e.request)),CacheFirst=async e=>caches.match(e.request).then((async r=>(logger.group.info("CacheFirst: "+new URL(e.request.url).pathname),logger.wait("service worker fetch: "+e.request.url),r?(logger.group.ready("Cache Hit"),console.log(r),logger.group.end(),logger.group.end(),"false"===await db.read("NPMMirror")&&new RegExp(location.origin).test(e.request.url)?logger.ready("[CacheAlways] NPM Tarball Source Enabled! NPM Mirror Disabled!"):e.waitUntil(CacheRuntime(e.request)),r):(logger.warn("Cache Miss"),logger.group.end(),CacheRuntime(e.request))))),CacheAlways=async e=>caches.match(e.request).then((function(r){return logger.group.info("CacheAlways: "+new URL(e.request.url).pathname),logger.wait("service worker fetch: "+e.request.url),r?(logger.group.ready("Cache Hit"),console.log(r),logger.group.end(),logger.group.end(),r):(logger.warn("Cache Miss"),logger.group.end(),CacheRuntime(e.request))})),matchCache=async e=>caches.match(e.request).then((function(r){return logger.group.info("service worker fetch: "+e.request.url),r?(logger.group.ready("Cache Hit"),console.log(r),logger.group.end(),logger.group.end(),r):(logger.warn("Cache Miss"),logger.group.end(),CacheRuntime(e.request))}));async function CacheRuntime(e){const r=new URL(e.url);let t=await matchCDN(e);if(t||(t=await fetch(e).catch((()=>null))),logger.group.event(`Cache Runtime ${r.pathname}`),logger.wait(`Caching url: ${e.url}`),console.log(t),"GET"===e.method&&"https:"==r.protocol){(await caches.open(CACHE_NAME+"-runtime")).put(e,t.clone()).catch((e=>{logger.error("[Cache Runtime] "+(e.stack||e)),"QuotaExceededError"===e.name&&(caches.delete(CACHE_NAME+"-runtime"),logger.ready("deleted cache"))})),logger.ready(`Cached url: ${e.url}`)}else logger.warn(`Not Cached url: ${e.url}`);return logger.group.end(),t}const matchCDN=async e=>{const r=navigator,{saveData:t,effectiveType:o}=r.connection||r.mozConnection||r.webkitConnection||{};if(t||/2g/.test(o))return logger.warn("Slow Network: Transparent Proxy"),fetch(e);const a=[];let n,s=new URL(e.url),c=s.pathname.split("/")[1];if(NPMMirror&&"true"===await db.read("NPMMirror")&&new RegExp(location.origin).test(e.url)){logger.group.ready("Match NPM Mirror: "+e.url);for(const r in cdn.npm){let t=cdn.npm[r]+"/"+"@mhg/blog@"+NPMPackageVersion+e.url.replace(location.origin,"");t=fullPath(t),console.log(t),a.push(t)}logger.group.end()}if(!a.length){for(const r of cdn_match_list)if(new RegExp(r.key).test(e.url)){c=r.type;break}for(const r in cdn)if(r===c){logger.group.ready(`Match CDN ${c}: `+e.url);for(const e in cdn[r]){const t=cdn[r][e]+s.pathname.replace("/"+c,"");console.log(t),a.push(t)}logger.group.end()}}if(n=a.length?fetchAny(a):fetch(e),n&&NPMMirror&&new RegExp(location.origin).test(e.url)){const r=fullPath(e.url).split(".").pop(),t=getContentType(r);n=n.then((e=>e.arrayBuffer())).then((e=>new Response(e,{headers:{"Content-Type":t}}))).catch((()=>null))}return n},fullPath=e=>{if((e=e.split("?")[0].split("#")[0]).endsWith("/"))e+="index.html";else{const r=e.split("/");-1===r[r.length-1].indexOf(".")&&(e+=".html")}return e};async function progress(e){return new Response(await e.arrayBuffer(),{status:e.status,headers:e.headers})}function createPromiseAny(){Promise.any=function(e){return new Promise(((r,t)=>{let o=(e=Array.isArray(e)?e:[]).length,a=[];if(0===o)return t(new AggregateError("All promises were rejected"));e.forEach((e=>{e instanceof Promise?e.then((e=>r(e)),(e=>{o--,a.push(e),0===o&&t(new AggregateError(a))})):t(e)}))}))}}function fetchAny(e){const r=new AbortController,t=r.signal,o=e.map((e=>new Promise(((o,a)=>{fetch(e,{signal:t}).then(progress).then((e=>{const t=e.clone();200!==t.status&&a(null),r.abort(),o(t)})).catch((()=>a(null)))}))));return Promise.any||createPromiseAny(),Promise.any(o).then((e=>e)).catch((()=>null))}importScripts("/untgz.js");const getNpmSource=async()=>{if(!NPMTarball)return;if("true"===await db.read("NPMTarball"))return;if(!tarball)return;if("true"===await db.read("DownloadingNPMSource"))return;await db.write("DownloadingNPMSource","true"),logger.wait("Downloading NPM Source: "+tarball);const e=tarball.replace("https://registry.npmmirror.com/","https://registry.npmjs.org/"),r=cors_anywhere+e;caches.open(CACHE_NAME+"-npmtgz").then((async e=>{await FetchUntgz(r).then((async r=>{for await(const t of r)console.log(t),await putNpmSource(e,t);await db.write("NPMMirror","false"),await db.write("NPMTarball","true"),await db.write("DownloadingNPMSource","false"),logger.bg.ready("[CacheAlways] NPM Mirror Disabled!")}))})).catch((async e=>{await db.write("DownloadingNPMSource","false"),logger.error("[Cache Npm Tarball Source] "+(e.stack||e))}))},putNpmSource=async(e,r)=>{const t=r.name.replace(/^package/,location.origin),o=t.split(".").pop(),a=t.replace(/index.html$/,"").replace(/.html$/,""),n=getContentType(o);e.put(new Request(a),new Response(r.buffer,{headers:{"Content-Type":n}}))},getContentType=e=>{switch(e){case"js":return"text/javascript";case"html":return"text/html";case"css":return"text/css";case"json":case"map":return"application/json";case"webp":return"image/webp";case"jpg":return"image/jpg";case"jpeg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";case"xml":case"xsl":return"text/xml";case"webmanifest":return"text/webmanifest";case"bcmap":case"wbmp":return"image/vnd.wap.wbmp";case"bmp":return"image/bmp";case"ico":return"image/vnd.microsoft.icon";case"tiff":case"tif":return"image/tiff";case"svg":case"svgz":return"image/svg+xml";case"woff":return"application/font-woff";case"woff2":return"application/font-woff2";case"ttf":return"application/font-ttf";case"otf":return"application/font-otf";case"eot":return"application/vnd.ms-fontobject";case"zip":return"application/zip";case"tar":return"application/x-tar";case"gz":return"application/gzip";case"bz2":return"application/x-bzip2";case"rar":return"application/x-rar-compressed";case"7z":return"application/x-7z-compressed";case"doc":return"application/msword";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"ppt":return"application/vnd.ms-powerpoint";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"pdf":return"application/pdf";case"txt":default:return"text/plain";case"rtf":return"application/rtf";case"mp3":return"audio/mpeg";case"wav":return"audio/x-wav";case"ogg":return"audio/ogg";case"mp4":return"video/mp4";case"m4v":return"video/x-m4v";case"mov":return"video/quicktime";case"avi":return"video/x-msvideo";case"wmv":return"video/x-ms-wmv";case"flv":return"video/x-flv";case"swf":return"application/x-shockwave-flash";case"mpg":case"mpeg":case"mpe":case"mpv":case"m2v":return"video/mpeg";case"m4a":return"audio/mp4";case"aac":return"audio/aac";case"m3u":return"audio/x-mpegurl";case"m3u8":return"application/vnd.apple.mpegurl";case"pls":return"audio/x-scpls";case"cue":return"application/x-cue";case"wma":return"audio/x-ms-wma";case"flac":return"audio/flac";case"aif":case"aiff":case"aifc":return"audio/x-aiff";case"au":case"snd":return"audio/basic";case"mid":case"midi":case"kar":return"audio/midi"}};
//# sourceMappingURL=maps/jquery.js.map
