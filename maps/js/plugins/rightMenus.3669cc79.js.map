{"version":3,"sources":["js/plugins/rightMenus.3669cc79.js"],"names":["RightMenus","defaultEvent","defaultGroup","messageRightMenu","volantis","GLOBAL_CONFIG","plugins","message","enable","rightmenu","corsAnywhere","rightmenus","options","urlRegx","imgRegx","initialMenu","fun","init","pjax","send","hideMenu","isReadModel","readMode","readClipboard","async","result","navigator","permissions","query","name","state","clipboard","readText","then","text","catch","err","Promise","reject","writeClipText","writeText","resolve","writeClipImg","link","success","error","image","Image","crossOrigin","addEventListener","canvas","document","createElement","context","getContext","width","height","drawImage","toBlob","blob","write","ClipboardItem","e","src","insertAtCaret","elemt","value","startPos","selectionStart","endPos","selectionEnd","selection","focus","createRange","scrollTop","substring","length","rightMenuConfig","fn","_rightMenuWrapper","getElementById","_rightMenuContent","_rightMenuList","querySelectorAll","_rightMenuListWithHr","_readBkg","_menuMusic","_backward","querySelector","_toggle","_forward","globalData","mouseEvent","isInputBox","selectText","inputValue","isLink","linkUrl","isMediaLink","mediaLinkUrl","isImage","isArticle","pathName","isReadClipboard","isShowMusic","statusCheck","globalDataBackup","Object","assign","initEvent","elementAppend","contextmenu","menuEvent","parentNode","removeChild","readBkg","className","id","window","body","appendChild","menuPosition","event","mouseClientX","clientX","mouseClientY","clientY","screenWidth","documentElement","clientWidth","screenHeight","clientHeight","style","display","menuControl","menuWidth","offsetWidth","menuHeight","offsetHeight","showLeft","showTop","left","top","notice","menuNotic","debug","console","globalDataSet","forEach","item","nodeName","firstElementChild","groupName","getAttribute","itemEvent","articleShowLink","every","elementHrItem","hide","nextElementSibling","getSelection","toString","target","tagName","toLowerCase","href","test","currentSrc","location","pathname","aplayer","RightMenuAplayer","undefined","APlayer","player","musicAlwaysShow","status","oncontextmenu","ctrlKey","stopPropagation","preventDefault","removeEventListener","eventName","RightMenusFunction","VolantisApp","icon","iconPrefix","time","onclick","aplayerBackward","aplayerToggle","aplayerForward","NoticeRightMenu","localStorage","getItem","displayMode","setItem","copyText","utilWriteClipText","messageCopyright","copyLink","copyAll","select","copyPaste","copyCut","statrPos","inputStr","copyImg","hideMessage","printMode","question","printHtml","DOMController","setAttribute","removeList","setStyleList","setTimeout","print","innerHTML","reload","ScrollReveal","clean","fadeToggleList","toggleClassList","backgroundColor","hasClass","freeze","requestAnimationFrame","readyState"],"mappings":"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","file":"../../../js/plugins/rightMenus.3669cc79.js","sourcesContent":["\nconst RightMenus = {\n  defaultEvent: ['copyText', 'copyLink', 'copyPaste', 'copyAll', 'copyCut', 'copyImg', 'printMode', 'readMode'],\n  defaultGroup: ['navigation', 'inputBox', 'seletctText', 'elementCheck', 'elementImage', 'articlePage'],\n  messageRightMenu: volantis.GLOBAL_CONFIG.plugins.message.enable && volantis.GLOBAL_CONFIG.plugins.message.rightmenu.enable,\n  corsAnywhere: volantis.GLOBAL_CONFIG.plugins.rightmenus.options.corsAnywhere,\n  urlRegx: /^((https|http)?:\\/\\/)+[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&_~`@[\\]\\':+!]*([^<>\\\"\\\"])*$/,\n  imgRegx: /\\.(jpe?g|png|webp|svg|gif|jifi)$/,\n\n  /**\n   * 加载右键菜单\n   */\n  initialMenu: () => {\n    RightMenus.fun.init();\n    volantis.pjax.send(() => {\n      RightMenus.fun.hideMenu();\n      if (volantis.isReadModel) RightMenus.fun.readMode();\n    })\n  },\n\n  /**\n   * 读取剪切板\n   * @returns text\n   */\n  readClipboard: async () => {\n    const result = await navigator.permissions.query({\n      name: 'clipboard-read'\n    });\n    if (result.state === 'granted' || result.state === 'prompt') {\n      return navigator.clipboard\n        .readText()\n        .then(text => text)\n        .catch(err => Promise.reject(err));\n    }\n    return Promise.reject(result);\n  },\n\n  /**\n   * 写入文本到剪切板\n   * @param {String} text \n   */\n  writeClipText: text => {\n    return navigator.clipboard\n      .writeText(text)\n      .then(() => {\n        return Promise.resolve()\n      })\n      .catch(err => {\n        return Promise.reject(err)\n      })\n  },\n\n  /**\n   * 写入图片到剪切板\n   * @param {*} link \n   * @param {*} success \n   * @param {*} error \n   */\n  writeClipImg: async (link, success, error) => {\n    const image = new Image;\n    image.crossOrigin = \"Anonymous\";\n    image.addEventListener('load', () => {\n      let canvas = document.createElement(\"canvas\");\n      let context = canvas.getContext(\"2d\");\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      canvas.toBlob(blob => {\n        navigator.clipboard.write([\n          new ClipboardItem({ 'image/png': blob })\n        ]).then(e => {\n          success(e)\n        }).catch(e => {\n          error(e)\n        })\n      }, 'image/png')\n    }, false)\n    image.src = `${RightMenus.corsAnywhere ? RightMenus.corsAnywhere : ''}${link}`;\n  },\n\n  /**\n   * 粘贴文本到剪切板\n   * @param {*} elemt \n   * @param {*} value \n   */\n  insertAtCaret: (elemt, value) => {\n    const startPos = elemt.selectionStart,\n      endPos = elemt.selectionEnd;\n    if (document.selection) {\n      elemt.focus();\n      var sel = document.selection.createRange();\n      sel.text = value;\n      elemt.focus();\n    } else {\n      if (startPos || startPos == '0') {\n        var scrollTop = elemt.scrollTop;\n        elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n        elemt.focus();\n        elemt.selectionStart = startPos + value.length;\n        elemt.selectionEnd = startPos + value.length;\n        elemt.scrollTop = scrollTop;\n      } else {\n        elemt.value += value;\n        elemt.focus();\n      }\n    }\n  }\n}\n\n/**\n * 事件处理区域\n */\nRightMenus.fun = (() => {\n  const rightMenuConfig = volantis.GLOBAL_CONFIG.plugins.rightmenus;\n\n  const\n    fn = {},\n    _rightMenuWrapper = document.getElementById('rightmenu-wrapper'),\n    _rightMenuContent = document.getElementById('rightmenu-content'),\n    _rightMenuList = document.querySelectorAll('#rightmenu-content li.menuLoad-Content'),\n    _rightMenuListWithHr = document.querySelectorAll('#rightmenu-content li, #rightmenu-content hr, #menuMusic'),\n    _readBkg = document.getElementById('read_bkg'),\n    _menuMusic = document.getElementById('menuMusic'),\n    _backward = document.querySelector('#menuMusic .backward'),\n    _toggle = document.querySelector('#menuMusic .toggle'),\n    _forward = document.querySelector('#menuMusic .forward');\n\n  // 公共数据\n  let globalData = {\n    mouseEvent: null,\n    isInputBox: false,\n    selectText: '',\n    inputValue: '',\n    isLink: false,\n    linkUrl: '',\n    isMediaLink: false,\n    mediaLinkUrl: '',\n    isImage: false,\n    isArticle: false,\n    pathName: '',\n    isReadClipboard: false,\n    readClipboard: '',\n    isShowMusic: false,\n    statusCheck: false\n  }\n  const globalDataBackup = Object.assign({}, globalData);\n\n  /**\n   * 初始化监听事件处理\n   */\n  fn.initEvent = () => {\n    fn.elementAppend();\n    fn.contextmenu();\n    fn.menuEvent();\n  }\n\n  /**\n   * 预置元素设定\n   */\n  fn.elementAppend = () => {\n    // 阅读模式\n    if (_readBkg) _readBkg.parentNode.removeChild(_readBkg);\n    const readBkg = document.createElement(\"div\");\n    readBkg.className = \"common_read_bkg common_read_hide\";\n    readBkg.id = \"read_bkg\";\n    window.document.body.appendChild(readBkg);\n  }\n\n  /**\n   * 右键菜单位置设定\n   * @param {*} event \n   */\n  fn.menuPosition = (event) => {\n    try {\n      let mouseClientX = event.clientX;\n      let mouseClientY = event.clientY;\n      let screenWidth = document.documentElement.clientWidth || document.body.clientWidth;\n      let screenHeight = document.documentElement.clientHeight || document.body.clientHeight;\n\n      _rightMenuWrapper.style.display = 'block';\n      fn.menuControl(event);\n\n      let menuWidth = _rightMenuContent.offsetWidth;\n      let menuHeight = _rightMenuContent.offsetHeight;\n      let showLeft = mouseClientX + menuWidth > screenWidth ? mouseClientX - menuWidth + 10 : mouseClientX;\n      let showTop = mouseClientY + menuHeight > screenHeight ? mouseClientY - menuHeight + 10 : mouseClientY;\n      showTop = mouseClientY + menuHeight > screenHeight && showTop < menuHeight && mouseClientY < menuHeight ?\n        showTop + (screenHeight - menuHeight - showTop - 10) : showTop;\n      _rightMenuWrapper.style.left = `${showLeft}px`;\n      _rightMenuWrapper.style.top = `${showTop}px`;\n      if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) fn.menuNotic();\n    } catch (error) {\n      if (volantis.GLOBAL_CONFIG.debug) console.error(error);\n      fn.hideMenu();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 菜单项控制\n   * @param {*} event \n   */\n  fn.menuControl = (event) => {\n    fn.globalDataSet(event);\n    if (!!_menuMusic) _menuMusic.style.display = globalData.isShowMusic ? 'block' : 'none';\n    _rightMenuList.forEach(item => {\n      item.style.display = 'none';\n      const nodeName = item.firstElementChild.nodeName;\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      const itemEvent = item.firstElementChild.getAttribute('data-event');\n      if (globalData.statusCheck || globalData.isArticle) {\n        switch (groupName) {\n          case 'inputBox':\n            if (globalData.isInputBox) {\n              item.style.display = 'block';\n              if (itemEvent === 'copyCut' && !globalData.selectText) item.style.display = 'none';\n              if (itemEvent === 'copyAll' && !globalData.inputValue) item.style.display = 'none';\n              if (globalData.isInputBox && itemEvent === 'copyPaste')\n                RightMenus.readClipboard().then(text => {\n                  if (!!text) {\n                    globalData.isReadClipboard = true;\n                    globalData.readClipboard = text;\n                  } else {\n                    item.style.display = 'none';\n                  }\n                }).catch(() => {\n                  item.style.display = 'none';\n                })\n            }\n            break;\n          case 'seletctText':\n            if (!!globalData.selectText) item.style.display = 'block';\n            break;\n          case 'elementCheck':\n            if (globalData.isLink || globalData.isMediaLink) item.style.display = 'block';\n            break;\n          case 'elementImage':\n            if (globalData.isImage) item.style.display = 'block';\n            break;\n          case 'articlePage':\n            if (globalData.isArticle) item.style.display = 'block';\n            break;\n          default:\n            item.style.display = nodeName === 'A'\n              ? globalData.isArticle && !globalData.statusCheck && rightMenuConfig.options.articleShowLink\n                ? 'block'\n                : 'none'\n              : 'block';\n            break;\n        }\n      } else if (nodeName === 'A' || RightMenus.defaultGroup.every(item => { return groupName !== item })) {\n        item.style.display = 'block';\n      }\n    })\n\n\n    let elementHrItem = { item: null, hide: true };\n    _rightMenuListWithHr.forEach((item) => {\n      if (item.nodeName === \"HR\") {\n        item.style.display = 'block';\n        if (!elementHrItem.item) {\n          elementHrItem.item = item;\n          return;\n        }\n        if (elementHrItem.hide || elementHrItem.item.nextElementSibling.nodeName === \"hr\") {\n          elementHrItem.item.style.display = 'none';\n        }\n        elementHrItem.item = item;\n        elementHrItem.hide = true;\n      } else {\n        if (item.style.display === 'block' && elementHrItem.hide) {\n          elementHrItem.hide = false;\n        }\n      }\n    })\n    if (!!elementHrItem.item && elementHrItem.hide) elementHrItem.item.style.display = 'none';\n  }\n\n  /**\n   * 元素状态判断/全局数据设置\n   * @param {*} event \n   */\n  fn.globalDataSet = (event) => {\n    globalData = Object.assign({}, globalDataBackup);\n    globalData.mouseEvent = event;\n    globalData.selectText = window.getSelection().toString();\n\n    // 判断是否为输入框\n    if (event.target.tagName.toLowerCase() === 'input' || event.target.tagName.toLowerCase() === 'textarea') {\n      globalData.isInputBox = true;\n      globalData.inputValue = event.target.value;\n    }\n\n    // 判断是否包含链接\n    if (!!event.target.href && RightMenus.urlRegx.test(event.target.href)) {\n      globalData.isLink = true;\n      globalData.linkUrl = event.target.href;\n    }\n\n    // 判断是否包含媒体链接\n    if (!!event.target.currentSrc && RightMenus.urlRegx.test(event.target.currentSrc)) {\n      globalData.isMediaLink = true;\n      globalData.mediaLinkUrl = event.target.currentSrc;\n    }\n\n    // 判断是否为图片地址\n    if (globalData.isMediaLink && RightMenus.imgRegx.test(globalData.mediaLinkUrl)) {\n      globalData.isImage = true;\n    }\n\n    // 判断是否为文章页面\n    if (!!(document.querySelector('#post.article') || null)) {\n      globalData.isArticle = true;\n      globalData.pathName = window.location.pathname;\n    }\n\n    // 判断是否显示音乐控制器\n    if (volantis.GLOBAL_CONFIG.plugins.aplayer.enable\n      && typeof RightMenuAplayer !== 'undefined'\n      && RightMenuAplayer.APlayer.player !== undefined) {\n      if (rightMenuConfig.options.musicAlwaysShow\n        || RightMenuAplayer.APlayer.status === 'play'\n        || RightMenuAplayer.APlayer.status === 'undefined') {\n        globalData.isShowMusic = true;\n      }\n    }\n\n    // 设定校验状态\n    if (!!globalData.selectText || globalData.isInputBox || globalData.isLink || globalData.isMediaLink) {\n      globalData.statusCheck = true;\n    }\n  }\n\n  /**\n   * 全局右键监听函数\n   */\n  fn.contextmenu = () => {\n    window.document.oncontextmenu = (event) => {\n      if (event.ctrlKey || document.body.offsetWidth <= 500) {\n        fn.hideMenu();\n        return true;\n      }\n      return fn.menuPosition(event);\n    }\n\n    _rightMenuWrapper.oncontextmenu = (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      return false;\n    }\n\n    window.removeEventListener('blur', fn.hideMenu);\n    window.addEventListener('blur', fn.hideMenu);\n    document.body.removeEventListener('click', fn.hideMenu);\n    document.body.addEventListener('click', fn.hideMenu);\n  }\n\n  /**\n   * 菜单项事件处理函数\n   */\n  fn.menuEvent = () => {\n    _rightMenuList.forEach(item => {\n      let eventName = item.firstElementChild.getAttribute('data-event');\n      const id = item.firstElementChild.getAttribute('id');\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      if (item.firstElementChild.nodeName === \"A\") return;\n      item.addEventListener('click', () => {\n        try {\n          if (RightMenus.defaultEvent.every(item => { return eventName !== item })) {\n            if (groupName === 'seletctText') {\n              RightMenusFunction[id](globalData.selectText)\n            } else if (groupName === 'elementCheck') {\n              RightMenusFunction[id](globalData.isLink ? globalData.linkUrl : globalData.mediaLinkUrl)\n            } else if (groupName === 'elementImage') {\n              RightMenusFunction[id](globalData.mediaLinkUrl)\n            } else {\n              RightMenusFunction[id]()\n            }\n          } else {\n            fn[eventName]()\n          }\n        } catch (error) {\n          if (volantis.GLOBAL_CONFIG.debug) {\n            console.error({\n              id: id,\n              error: error,\n              globalData: globalData,\n              groupName: groupName,\n              eventName: eventName\n            });\n          }\n          if (RightMenus.messageRightMenu) {\n            VolantisApp.message('错误提示', error, {\n              icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n              time: '15000'\n            });\n          }\n        }\n      })\n    })\n\n    if (_forward && _toggle && _forward) {\n      _backward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerBackward();\n      }\n      _toggle.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerToggle();\n      }\n      _forward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerForward();\n      }\n    }\n  }\n\n  /**\n   * 隐藏菜单显示\n   */\n  fn.hideMenu = () => {\n    _rightMenuWrapper.style.display = null;\n    _rightMenuWrapper.style.left = null;\n    _rightMenuWrapper.style.top = null;\n  }\n\n  /**\n   * 右键菜单覆盖提示\n   */\n  fn.menuNotic = () => {\n    const NoticeRightMenu = localStorage.getItem('NoticeRightMenu') === 'true';\n    if (RightMenus.messageRightMenu && !NoticeRightMenu)\n      VolantisApp.message('右键菜单', '唤醒原系统菜单请使用：<kbd>Ctrl</kbd> + <kbd>右键</kbd>', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n        displayMode: 1,\n        time: 9000\n      }, () => {\n        localStorage.setItem('NoticeRightMenu', 'true')\n      });\n  }\n\n  fn.copyText = () => {\n    VolantisApp.utilWriteClipText(globalData.selectText)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyLink = () => {\n    VolantisApp.utilWriteClipText(globalData.linkUrl || globalData.mediaLinkUrl)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyAll = () => {\n    globalData.mouseEvent.target.select();\n  }\n\n  fn.copyPaste = () => {\n    RightMenus.insertAtCaret(globalData.mouseEvent.target, globalData.readClipboard);\n  }\n\n  fn.copyCut = () => {\n    const statrPos = globalData.mouseEvent.target.selectionStart;\n    const endPos = globalData.mouseEvent.target.selectionEnd;\n    const inputStr = globalData.inputValue;\n    fn.copyText(globalData.selectText);\n    globalData.mouseEvent.target.value = inputStr.substring(0, statrPos) + inputStr.substring(endPos, inputStr.length);\n    globalData.mouseEvent.target.selectionStart = statrPos;\n    globalData.mouseEvent.target.selectionEnd = statrPos;\n    globalData.mouseEvent.target.focus();\n  }\n\n  fn.copyImg = () => {\n    if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) {\n      VolantisApp.message('系统提示', '复制中，请等待。', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n      })\n    }\n    RightMenus.writeClipImg(globalData.mediaLinkUrl, e => {\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '图片复制成功！', {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n        });\n      }\n    }, (e) => {\n      console.error(e);\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '复制失败：' + e, {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n          time: 9000\n        });\n      }\n    })\n  }\n\n  fn.printMode = () => {\n    if (window.location.pathname === globalData.pathName) {\n      if (RightMenus.messageRightMenu) {\n        const message = '是否打印当前页面？<br><em style=\"font-size: 80%\">建议打印时勾选背景图形</em><br>'\n        VolantisApp.question('', message, { time: 9000 }, () => { fn.printHtml() })\n      } else {\n        fn.printHtml()\n      }\n    }\n  }\n\n  fn.printHtml = () => {\n    if (volantis.isReadModel) fn.readMode();\n    DOMController.setAttribute('details', 'open', 'true');\n    DOMController.removeList([\n      '.cus-article-bkg', '.iziToast-overlay', '.iziToast-wrapper', '.prev-next',\n      'footer', '#l_header', '#l_cover', '#l_side', '#comments', '#s-top', '#BKG',\n      '#rightmenu-wrapper', '.nav-tabs', '.parallax-mirror', '.new-meta-item.share', 'div.footer'\n    ]);\n    DOMController.setStyleList([\n      ['body', 'backgroundColor', 'unset'], ['#l_main', 'width', '100%'], ['#post', 'boxShadow', 'none'],\n      ['#post', 'background', 'none'], ['#post', 'padding', '0'], ['h1', 'textAlign', 'center'],\n      ['h1', 'fontWeight', '600'], ['h1', 'fontSize', '2rem'], ['h1', 'marginBottom', '20px'],\n      ['.tab-pane', 'display', 'block'], ['.tab-content', 'borderTop', 'none'], ['.highlight>table pre', 'whiteSpace', 'pre-wrap'],\n      ['.highlight>table pre', 'wordBreak', 'break-all'], ['.fancybox img', 'height', 'auto'], ['.fancybox img', 'weight', 'auto']\n    ]);\n    setTimeout(() => {\n      window.print();\n      document.body.innerHTML = '';\n      window.location.reload();\n    }, 50);\n  }\n\n  fn.readMode = () => {\n    if (typeof ScrollReveal === 'function') ScrollReveal().clean('#comments');\n    DOMController.fadeToggleList([\n      document.querySelector('#l_header'), document.querySelector('footer'),\n      document.querySelector('#s-top'), document.querySelector('.article-meta#bottom'),\n      document.querySelector('.prev-next'), document.querySelector('#l_side'),\n      document.querySelector('#comments')\n    ]);\n    DOMController.toggleClassList([\n      [document.querySelector('#l_main'), 'common_read'], [document.querySelector('#l_main'), 'common_read_main'],\n      [document.querySelector('#l_body'), 'common_read'], [document.querySelector('#safearea'), 'common_read'],\n      [document.querySelector('#pjax-container'), 'common_read'], [document.querySelector('#read_bkg'), 'common_read_hide'],\n      [document.querySelector('h1'), 'common_read_h1'], [document.querySelector('#post'), 'post_read'],\n      [document.querySelector('#l_cover'), 'read_cover'], [document.querySelector('.widget.toc-wrapper'), 'post_read']\n    ]);\n    volantis.isReadModel = volantis.isReadModel === undefined ? true : !volantis.isReadModel;\n    if (volantis.isReadModel) {\n      if (RightMenus.messageRightMenu) VolantisApp.message('系统提示', '阅读模式已开启，您可以点击屏幕空白处退出。', {\n        backgroundColor: 'var(--color-read-post)',\n        icon: rightMenuConfig.options.iconPrefix + ' fa-book-reader',\n        displayMode: 1,\n        time: 5000\n      });\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#l_body').addEventListener('click', (event) => {\n        if (DOMController.hasClass(event.target, 'common_read')) {\n          fn.readMode();\n        }\n      });\n    } else {\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#post').removeEventListener('click', fn.readMode);\n      document.querySelector('.prev-next').style.display = 'flex'; // 单独修改 \n    }\n  }\n\n  return {\n    init: fn.initEvent,\n    hideMenu: fn.hideMenu,\n    readMode: fn.readMode\n  }\n})()\n\nObject.freeze(RightMenus);\nvolantis.requestAnimationFrame(() => {\n  if (document.readyState !== 'loading') {\n    RightMenus.initialMenu();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      RightMenus.initialMenu();\n    })\n  }\n});\n"]}